<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Compare Two PDF Files</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input { margin-bottom: 10px; display: block; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; vertical-align: top; }
    th { background: #f0f0f0; }
    .same { background-color: #e6ffe6; }
    .diff { background-color: #ffe6e6; }
  </style>
</head>
<body>

<h2>Compare Two PDF Files</h2>

<input type="file" id="pdf1" accept="application/pdf" />
<input type="file" id="pdf2" accept="application/pdf" />
<button onclick="comparePDFs()">Compare</button>

<table id="resultTable" style="display: none;">
  <thead>
    <tr>
      <th>Line #</th>
      <th>File 1</th>
      <th>File 2</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  async function extractPDFText(file) {
    const buffer = await file.arrayBuffer();
    const pdf = await pdfjsLib.getDocument({ data: buffer }).promise;
    let fullText = "";
    for (let i = 1; i <= pdf.numPages; i++) {
      const page = await pdf.getPage(i);
      const content = await page.getTextContent();
      const strings = content.items.map(item => item.str);
      fullText += strings.join('\n') + '\n';
    }
    return fullText.split(/\r?\n/).map(line => line.trim()).filter(line => line);
  }

  async function comparePDFs() {
    const file1 = document.getElementById('pdf1').files[0];
    const file2 = document.getElementById('pdf2').files[0];
    if (!file1 || !file2) {
      alert("Please upload both PDF files.");
      return;
    }

    const lines1 = await extractPDFText(file1);
    const lines2 = await extractPDFText(file2);

    const maxLines = Math.max(lines1.length, lines2.length);
    const tbody = document.querySelector("#resultTable tbody");
    tbody.innerHTML = "";

    for (let i = 0; i < maxLines; i++) {
      const line1 = lines1[i] || "";
      const line2 = lines2[i] || "";
      const isSame = line1 === line2;
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${i + 1}</td>
        <td class="${isSame ? 'same' : 'diff'}">${line1}</td>
        <td class="${isSame ? 'same' : 'diff'}">${line2}</td>
        <td class="${isSame ? 'same' : 'diff'}">${isSame ? 'Same' : 'Different'}</td>
      `;
      tbody.appendChild(row);
    }

    document.getElementById("resultTable").style.display = "table";
  }
</script>

</body>
</html>
