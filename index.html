<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Car B/L Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    .checkboxes label { margin-right: 10px; }
    .section-box {
      border: 1px solid #ccc;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 10px;
      background: #f9f9f9;
    }
  </style>
</head>
<body class="p-4">
  <div class="container">
    <h2 class="mb-4 text-center">Bill of Lading Generator</h2>
    <form id="bolForm">

      <div class="section-box">
        <h5>Shipper Info</h5>
        <div class="mb-3">
          <label>Shipper Name:</label>
          <input type="text" class="form-control" id="shipper" required />
        </div>
        <div class="mb-3">
          <label>Shipper Address:</label>
          <input type="text" class="form-control" id="shipperAddress" />
        </div>
      </div>

      <div class="section-box">
        <h5>Consignee Info</h5>
        <div class="mb-3">
          <label>Consignee Name:</label>
          <input type="text" class="form-control" id="consignee" required />
        </div>
        <div class="mb-3">
          <label>Consignee Address:</label>
          <input type="text" class="form-control" id="consigneeAddress" />
        </div>
      </div>

      <div class="section-box">
        <h5>Notify Party</h5>
        <div class="mb-3">
          <label>Notify:</label>
          <input type="text" class="form-control" id="notify" />
        </div>
      </div>

      <div class="row mb-3">
        <div class="col-md-6">
          <label>Invoicing:</label>
          <input type="text" class="form-control" id="invoicing" />
        </div>
        <div class="col-md-3">
          <label>Port of Loading:</label>
          <input type="text" class="form-control" id="port" />
        </div>
        <div class="col-md-3">
          <label>Destination:</label>
          <input type="text" class="form-control" id="destination" />
        </div>
      </div>

      <h5>Car Details</h5>
      <div id="carList"></div>
      <button type="button" class="btn btn-secondary my-3" onclick="addCar()">Add Car</button>
      <br />
      <button type="submit" class="btn btn-primary">Generate B/L PDF</button>
    </form>
  </div>

  <script>
    let carIndex = 0;

    function addCar() {
      const container = document.createElement('div');
      container.classList.add('card', 'p-3', 'mb-3');
      container.innerHTML = `
        <div class="row mb-2">
          <div class="col-md-3">
            <label>Car Name:</label>
            <input type="text" class="form-control" name="carName${carIndex}" />
          </div>
          <div class="col-md-3">
            <label>VIN:</label>
            <input type="text" class="form-control" name="vin${carIndex}" />
          </div>
          <div class="col-md-2">
            <label>Price:</label>
            <input type="text" class="form-control" name="price${carIndex}" />
          </div>
          <div class="col-md-4">
            <label>B13 Info:</label>
            <input type="text" class="form-control" name="b13${carIndex}" />
          </div>
        </div>
        <div class="checkboxes">
          <label><input type="checkbox" name="title${carIndex}" /> Title</label>
          <label><input type="checkbox" name="key${carIndex}" /> Key</label>
          <label><input type="checkbox" name="r${carIndex}" /> R</label>
          <label><input type="checkbox" name="acc${carIndex}" /> Acc</label>
          <label><input type="checkbox" name="nr${carIndex}" /> NR</label>
          <label><input type="checkbox" name="nacc${carIndex}" /> NACC</label>
        </div>
      `;
      document.getElementById('carList').appendChild(container);
      carIndex++;
    }

    document.getElementById('bolForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      let y = 10;
      doc.setFontSize(14);
      doc.text('BILL OF LADING', 105, y, { align: 'center' });
      y += 10;

      function writeText(label, value) {
        doc.setFontSize(11);
        doc.text(`${label}: ${value}`, 10, y);
        y += 6;
      }

      writeText('Shipper', document.getElementById('shipper').value);
      writeText('Shipper Address', document.getElementById('shipperAddress').value);
      writeText('Consignee', document.getElementById('consignee').value);
      writeText('Consignee Address', document.getElementById('consigneeAddress').value);
      writeText('Notify Party', document.getElementById('notify').value);
      writeText('Invoicing', document.getElementById('invoicing').value);
      writeText('Port of Loading', document.getElementById('port').value);
      writeText('Destination', document.getElementById('destination').value);

      y += 5;
      doc.setFontSize(12);
      doc.text('Car Details:', 10, y);
      y += 7;

      const carCards = document.querySelectorAll('#carList .card');
      carCards.forEach((card, index) => {
        const name = card.querySelector(`[name="carName${index}"]`).value;
        const vin = card.querySelector(`[name="vin${index}"]`).value;
        const price = card.querySelector(`[name="price${index}"]`).value;
        const b13 = card.querySelector(`[name="b13${index}"]`).value;
        const title = card.querySelector(`[name="title${index}"]`).checked ? 'Title' : '';
        const key = card.querySelector(`[name="key${index}"]`).checked ? 'Key' : '';
        const r = card.querySelector(`[name="r${index}"]`).checked ? 'R' : '';
        const acc = card.querySelector(`[name="acc${index}"]`).checked ? 'Acc' : '';
        const nr = card.querySelector(`[name="nr${index}"]`).checked ? 'NR' : '';
        const nacc = card.querySelector(`[name="nacc${index}"]`).checked ? 'NACC' : '';
        const conditions = [title, key, r, acc, nr, nacc].filter(Boolean).join(', ');

        doc.setFontSize(10);
        doc.text(`${index + 1}) ${name} | VIN: ${vin} | Price: $${price} | B13: ${b13}`, 10, y);
        y += 5;
        doc.text(`    Condition: ${conditions}`, 10, y);
        y += 7;

        if (y > 270) {
          doc.addPage();
          y = 10;
        }
      });

      doc.save('bill_of_lading.pdf');
    });
  </script>
</body>
</html>
